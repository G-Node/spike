{% load i18n %}
{% load spike_tags %}
{% load module_tags %}

<div class="accordion-group">
  <div class="accordion-heading clearfix">

    {% comment %}
    <div class="well pull-right">
      {% if ev.processed %}
        {% with ev.summary_short as ev_sum %}
          <p>True positive: {{ ev_sum.TP|floatformat:2 }}%</p>
          <p>False positive: {{ ev_sum.FP|floatformat:2 }}%</p>
        {% endwith %}
      {% else %}
        <p>No results available yet.</p>
      {% endif %}
    </div>
    {% endcomment %}

    <dl class="dl-horizontal pull-left">
      <dt>
        <strong>Ident:</strong>
      </dt>
      <dd>
        {{ ev.trial }} ({{ ev }})
      </dd>
      <dt>
        <strong>Status:</strong>
      </dt>
      <dd>
        {{ ev.status }}
      </dd>
      <dt>
        <strong>Created:</strong>
      </dt>
      <dd>
        {% icn_time ev.created %}
      </dd>
      <dt>
        <strong>Modified:</strong>
      </dt>
      <dd>
        {% icn_time ev.modified %}
      </dd>
      <dt></dt>
      <dd><a class="accordion-toogle" href="#eval-{{ ev.id }}"
             data-toggle="collapse" data-parent="#trial-container">TOGGLE DETAILS</a>
      </dd>
    </dl>
  </div>

  <div id="eval-{{ ev.id }}" class="accordion-body collapse" style="margin: 5px;">
    {% if user.is_authenticated %}
      {% if bt|is_editable:user %}
        <form class="form well" method="POST">
          <span class="label">Actions:</span>
          <a href="{% url ev_run ev.id %}#" class="btn btn-mini">{% trans "Run Evaluation" %}</a>
          <a href="#" class="btn btn-mini" onclick="$('#show_log-{{ ev.id }}').toggle();return false;">
            {% trans "Show Log" %}</a>
        </form>
        <pre id="show_log-{{ ev.id }}" class="well"
             {% if ev.processed %}style="display:none"{% endif %}
                >{{ ev.task_log }}</pre>
      {% endif %}
    {% endif %}

    {% if ev.processed %}
      {% for mod in ev.modules %}
        {% render_results ev mod %}
      {% endfor %}
    {% endif %}
  </div>
</div>
