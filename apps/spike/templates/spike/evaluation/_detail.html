{% load i18n %}
{% load spike_tags %}
{% load module_tags %}

<div class="accordion-group">
  <div class="accordion-heading clearfix">

    <dl class="dl-horizontal pull-left">
      <dt>
        <strong>Ident:</strong>
      </dt>
      <dd>
        {{ ev.trial }} ({{ ev }})
      </dd>
      <dt>
        <strong>Status:</strong>
      </dt>
      <dd>
        {{ ev.status }}
      </dd>
      <dt>
        <strong>Created:</strong>
      </dt>
      <dd>
        {% icn_time ev.created %}
      </dd>
      <dt>
        <strong>Modified:</strong>
      </dt>
      <dd>
        {% icn_time ev.modified %}
      </dd>
      <dt></dt>
      <dd><a class="accordion-toogle" href="#eval-{{ ev.id }}"
             data-toggle="collapse" data-parent="#trial-container">TOGGLE DETAILS</a>
      </dd>
    </dl>
  </div>

  <div id="eval-{{ ev.id }}" class="accordion-body collapse" style="margin: 5px;">
    {% if user.is_authenticated %}
      {% if bt|is_editable:user %}
        <form class="form well" method="POST">
          <span class="label">Actions:</span>
          <a href="{% url ev_run ev.id %}#" class="btn btn-mini">{% trans "Run Evaluation" %}</a>
          <a href="#" class="btn btn-mini" onclick="$('#show_log-{{ ev.id }}').toggle();return false;">
            {% trans "Show Log" %}</a>
        </form>
        <pre id="show_log-{{ ev.id }}" class="well"
             {% if ev.processed %}style="display:none"{% endif %}
                >{{ ev.task_log }}</pre>
      {% endif %}
    {% endif %}

    {% if ev.processed %}
      {% for mod in ev.modules|sort %}
        <div class="well well-small">
          <h2>Module: {{ mod.name }}</h2>
          {% render_results ev mod %}
        </div>
      {% endfor %}
    {% endif %}
  </div>
</div>
