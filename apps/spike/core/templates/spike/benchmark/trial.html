{% extends "spike/benchmark/base.html" %}

{% load i18n %}
{% load spike_eval_tags %}
{% load bootstrap_tags %}

{% block head_title %}{T:{{ tr.id }}}&nbsp;{{ tr.name }}{% endblock %}

{% block content %}
  <section class=well>
    <form class="actions" method="POST">
      {% csrf_token %}
      <span class="label">Actions:</span>
      <a id="edit-trial-toggle" class="btn btn-mini">
        {% trans "Edit Trial" %}</a>
      <input class="btn btn-mini" name="tr_delete" type="submit"
       value="{% trans "Delete Trial" %}"/>
      <input class="btn btn-mini" name="tr_validate" type="submit"
       value="{% trans "Validate Trial" %}"/>
    </form>
    <form id="edit-trial" class="form form-horizontal well" method="POST"
     enctype="multipart/form-data" style="display:none">
      <fieldset>
        <legend>Edit Trial</legend>
        {% csrf_token %}
        {{ tr_form|as_bootstrap }}
        <div class="form-actions">
          <input type="submit" class="btn btn-primary" name="tr_edit"
           value="{% trans 'Edit Trial' %}"/>
        </div>
      </fieldset>
    </form>
  </section>

  <section>
    <h1>
      &quot;{{ tr.benchmark.name }}&quot;&nbsp;-&nbsp;&quot;{{ tr.name }}&quot;
    </h1>
    <dl class="dl-horizontal">
      <dt>
        <strong>Benchmark:</strong>
      </dt>
      <dd>
        <a href="{% url bm_detail tr.benchmark.id %}">
          {{ tr.benchmark.name }}</a>
      </dd>
      <dt>
        <strong>Description:</strong>
      </dt>
      <dd>
        {{ tr.description|default:"no description" }}
      </dd>
      <dt>
        <strong>{{ tr.benchmark.parameter }}:</strong>
      </dt>
      <dd>
        {{ tr.parameter }}
      </dd>
      <dt>
        <strong>Date Created:</strong>
      </dt>
      <dd>
        {% icn_time tr %}
      </dd>
      <dt>
        <strong>Status:</strong>
      </dt>
      <dd>
        {% if tr.is_validated %}
          <i class="icon-ok"></i>
          <strong style="color: green">VALID</strong>
        {% else %}
          <i class="icon-exclamation-sign"></i>
          <strong style="color: red">INVALID</strong>
        {% endif %}
      </dd>
    </dl>
  </section>

  <section>
    <h2>Validation Logs
      <small>per file logs of the validation run</small>
    </h2>

    <strong>{% trans "Rawdata File" %}</strong>
    {% if tr.rd_file %}
      ({{ tr.rd_file.get_task_state_display|default:"no rd_file!" }})
      <pre>{{ tr.rd_file.task_log|default:"no log!" }}</pre>
    {% endif %}
    <strong>{% trans "Groundtruth File" %}</strong>
    {% if tr.gt_file %}
      ({{ tr.gt_file.get_task_state_display|default:"no gt_file!" }})
      <pre>{{ tr.gt_file.task_log|default:"no log!" }}</pre>
    {% endif %}
  </section>
{% endblock %}

{% block extra_body %}
  <script type="text/javascript">
    $(document).ready(function() {
      $('#edit-trial-toggle').click(function() {
        $('#edit-trial').toggle();
        return false;
      });
      if($('#edit-trial .error').length) {
        $('#edit-trial').show();
        $('#edit-trial .error').autoscroll();
      }
      ;
    });
  </script>
{% endblock %}
