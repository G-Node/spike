{% extends "datasets/base.html" %}

{% load i18n %}
{% load uni_form %}
{% load humanize %}
{% load pagination_tags %}
{% load order_by %}
{% load extra_tagging_tags %}
{% load sorting_tags %}
{% load truncate_filter %}

{% block head_title %}{% blocktrans %}My Datasets{% endblocktrans %}{% endblock %}
{% block subnavi2_class %}aktiv{% endblock %}

{% block body %}
    <h1>{% trans "My Datasets" %}</h1>
    
    <p>{% trans "A <b>dataset</b> is used to group several files. You can create a <b>dataset</b> and attach any of your files to it. Any <b>dataset</b> may be futher linked to the experiment, published or shared with people you know." %}</p>
    {% if user.is_authenticated %}


    {% if not datasets %}
        <p>You don't have datasets. You may <a href="{% url dataset_create %}">Create</a> a new one.</p>
    {% else %}

        <p><a href="{% url dataset_create %}">Create</a> a new dataset.</p>
    {% autosort datasets %}
    {% autopaginate datasets 20 %}
	<p>{% trans "Order by:" %}
	    {% anchor title Name %}
	    {% anchor safety_level Privacy %}
	    {% anchor date_added Date %}
	</p>

        <form method="POST" action="">

        <table class="messages">
            <thead>
                <tr><th>{% trans "Title" %}</th><th>{% trans "Created" %}</th><th>{% trans "Objects" %}</th><th>{% trans "State" %}</th><th>{% trans "Action" %}</th><th>{% trans "Select" %}</th></tr>
            </thead>
            <tbody>
                {% for dataset in datasets %}
                    <tr>
                        <td><a href="{{ dataset.get_absolute_url }}">{{ dataset.title }}</a></td>
                        <td><nobr>{{ dataset.date_added|date:"Y-m-d H:i" }}</nobr></td>
                        <td>{{ dataset.objects_count_str }}</td>
                        <td>{% if dataset.is_Public %}<b style="color: red">Public</b>{% endif %}{% if dataset.is_Friendly %}Friendly{% endif %}{% if dataset.is_Private %}Private{% endif %}</td>
                        <td><nobr><a href="{% url dataset_delete dataset.id %}">{% trans "delete" %}</a></nobr></td>
                        <td><input id="id_set_choices_{{ dataset.id }}" type="checkbox" value="{{ dataset.id }}" name="set_choices"/></td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
	{% paginate %}
        
        <input type="hidden" name="action" value="delete" />
        <input type="submit" value="{% trans "delete selected" %}"/>

        </form>
    {% endif %}
    
    {% else %}
        {% url acct_signup as signup_url %}
        {% url acct_login as login_url %}
        <p>{% blocktrans %}<a href="{{ signup_url }}">Sign up</a> and <a href="{{ login_url }}">log in </a> to create your own dataset or join an existing one.{% endblocktrans %}</p>
    {% endif %}
    
{% endblock %}
