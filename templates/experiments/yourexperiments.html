{% extends "experiments/base.html" %}

{% load i18n %}
{% load humanize %}
{% load pagination_tags %}
{% load tagging_tags %}
{% load group_tags %}
{% load threadedcommentstags %}
{% load theme_tags %}
{% load sorting_tags %}
{% load projects_tags %}

{% block head_title %}{% blocktrans %}Your Experiments{% endblocktrans %}{% endblock %}
{% block subnavi2_class %}aktiv{% endblock %}


{% block body %}
  
    <h1>{% trans "My Experiments" %}</h1>
    
    {% if user.is_authenticated %}
        <p><a href="{% url experiment_create %}">Create</a> an Experiment. Or <a href="{% url datafile_create %}">upload</a> a file with experimental data or metadata.</p>

        <p>
            <form method="POST" action="">
                <p>{% trans "Order by:" %}
                    {% anchor title Name %}
                    {% anchor safety_level Privacy %}
                    {% anchor date_created Date %}
                </p>

                Show Experiments:
                {% ifequal fltr f_1 %}
                    <input type="submit" value="{{ f_1 }}" name="filter_choice" disabled="disabled"/>
                {% else %}
                    <input type="submit" value="{{ f_1 }}" name="filter_choice"/>
                {% endifequal%}
                {% ifequal fltr f_2 %}
                    <input type="submit" value="{{ f_2 }}" name="filter_choice" disabled="disabled"/>
                {% else %}
                    <input type="submit" value="{{ f_2 }}" name="filter_choice"/>
                {% endifequal%}
                {% ifequal fltr f_3 %}
                    <input type="submit" value="{{ f_3 }}" name="filter_choice" disabled="disabled"/>
                {% else %}
                    <input type="submit" value="{{ f_3 }}" name="filter_choice"/>
                {% endifequal%}
                {% ifequal fltr f_4 %}
                    <input type="submit" value="{{ f_4 }}" name="filter_choice" disabled="disabled"/>
                {% else %}
                    <input type="submit" value="{{ f_4 }}" name="filter_choice"/>
                {% endifequal%}
                {% ifequal fltr f_5 %}
                    <input type="submit" value="{{ f_5 }}" name="filter_choice" disabled="disabled"/>
                {% else %}
                    <input type="submit" value="{{ f_5 }}" name="filter_choice"/>
                {% endifequal%}

                {% if fltr %}
                    <input type="hidden" name="fltr" value="{{ fltr }}" />
                {% endif %}                
            </form>
        </p>

        {% comment %}
        <form action="" method="GET">
            <div class="task_filter">
                <ul>
                    {{ exp_filter.form.as_ul }}
                    <li><input type="submit" value="filter"/></li>
                </ul>
            </div>
        </form>
        {% endcomment %}
        
    {% if experiments %}
    {% autosort experiments %}
    {% autopaginate experiments %}

        <form method="POST" action="">
        
        <table class="messages">
            <thead>
                <tr><th>{% trans "Title" %}</th><th>{% trans "In Projects" %}</th><th>{% trans "Created" %}</th><th>{% trans "State" %}</th><th>{% trans "Action" %}</th><th>{% trans "Select" %}</th></tr>
            </thead>
            <tbody>
                {% for experiment in experiments %}
                    <tr>
                        <td><a href="{{ experiment.get_absolute_url }}">{{ experiment.title }}</a></td>
                        <td>
			{% for proj in experiment.in_projects.all %}
				<span><a href="{{ proj.get_absolute_url }}">{{ proj.slug }}</a>, </span>
			{% endfor %}
			</td>
                        <td><nobr>{{ experiment.date_created|date:"Y-m-d H:i" }}</nobr></td>
                        <td>{% if experiment.is_Public %}<b style="color: red">Public</b>{% endif %}{% if experiment.is_Friendly %}Friendly{% endif %}{% if experiment.is_Private %}Private{% endif %}</td>
                        <td><nobr><a href="{% url experiment_delete experiment.id %}">{% trans "delete" %}</a></nobr></td>
                        <td><input id="id_set_choices_{{ experiment.id }}" type="checkbox" value="{{ experiment.id }}" name="set_choices"/></td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% paginate %}

        <input type="hidden" name="action" value="delete" />
        <input type="submit" value="{% trans "delete selected" %}"/>

        </form>
    {% else %}
    <p>No experiments were found.</p>
    {% endif %}

    {% else %}
        {% url acct_signup as signup_url %}
        {% url acct_login as login_url %}
        <p>{% blocktrans %}<a href="{{ signup_url }}">Sign up</a> and <a href="{{ login_url }}">log in </a> to create experiments and organize or share your own datafiles.{% endblocktrans %}</p>
    {% endif %}
    
{% endblock %}
