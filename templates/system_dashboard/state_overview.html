{% extends "system_dashboard/base.html" %}

{% load i18n %}

{% block head_title %}System State - Overview{% endblock %}

{% block extra_head %}
	<script type="text/javascript" src="{{ STATIC_URL }}js/jquery.min.js"></script>
	<script type="text/javascript" src="{{ STATIC_URL }}js/highcharts.js"></script> 
	<script type="text/javascript"> 
		var chart;
		$(document).ready(function() {
			chart = new Highcharts.Chart({
				chart: {
					renderTo: 'container',
					margin: [40, 40, 12, 40]
				},
				title: {
					text: 'Total Disk Space Usage, MB'
				},
				plotArea: {
					shadow: null,
					borderWidth: null,
					backgroundColor: null
				},
				tooltip: {
					formatter: function() {
						return '<b>'+ this.point.name +'</b>: '+ this.y +' %';
					}
				},
				plotOptions: {
					pie: {
						allowPointSelect: true,
						dataLabels: {
							enabled: true,
							formatter: function() {
								if (this.y > 5) return this.point.name;
							},
							color: 'white',
							style: {
								font: '13px Trebuchet MS, Verdana, sans-serif'
							}
						}
					}
				},
				legend: {
					layout: 'vertical',
					style: {
						left: 'auto',
						bottom: 'auto',
						right: '10px',
						top: '30px'
					}
				},
			        series: [{
					type: 'pie',
					name: 'Disk space',
					data: [
						['Total',	{{ total_space }}],
						['Total Used',	{{ total_space_used }}]
					]
					//data: [3.40, 1.05, 2.90, 1.65, 1.35, 2.59, 1.39, 3.07, 2.82]
				}]
			});
			
			
		});
		</script> 
		
	<script type="text/javascript" src="{{ STATIC_URL }}js/highslide-full.min.js"></script> 
	<script type="text/javascript" src="{{ STATIC_URL }}js/highslide.config.js" charset="utf-8"></script> 
	<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}css/highslide.css" /> 
{% endblock %}


{% block body %}

    {% if user.is_authenticated and user.is_staff %}

    <div class="left_panel">
        <div class="photo-title">
            <h2>System State Overview - Totals</h2>
        </div>
        <table><tr><td>
        <table width=250px>
            <tr><td>USERS:<td><td width=180px align=right><b style="font-size:x-large">{{ user_count }}</b></td></tr>
            <tr><td>PROJECTS:<td><td align=right><b style="font-size:x-large">{{ project_count }}</b></td></tr>
            <tr><td>EXPERIMENTS:<td><td align=right><b style="font-size:x-large">{{ experiment_count }}</b></td></tr>
            <tr><td>DATASETS:<td><td align=right><b style="font-size:x-large">{{ dataset_count }}</b></td></tr>
            <tr><td>FILES:<td><td align=right><b style="font-size:x-large">{{ file_count }}</b></td></tr>
        </table>
	</td><td>
		<div id="container" style="width: 400px; height: 200px; margin: 0 auto"></div>
	</td></tr></table>
    </div>
    {% endif %}

{% endblock %}

