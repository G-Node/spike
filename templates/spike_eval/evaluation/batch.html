{% extends "spike_eval/evaluation/base.html" %}

{% load i18n %}
{% load spike_eval_tags %}
{% load bootstrap_tags %}

{% block head_title %}{E:{{ eb.id }}}&nbsp;{{ eb.benchmark }}{% endblock %}

{% block content %}


  <section class="well">
    <form class="actions" method="POST">
      {% csrf_token %}
      <span class="label">Actions:</span>
      {% if eb|is_editable:user %}
        <input type="submit" class="btn btn-mini" name="eb_switch"
                {% if eb.is_public %}
               value="{% trans "Unpublish Evaluation Batch" %}"
                {% else %}
               value="{% trans "Publish Evalulation Batch" %}"
                {% endif %}/>
        <a id="edit-batch-toggle" class="btn btn-mini">
          Edit Evaluation Batch</a>
      {% endif %}
      <a href="{% url e_dl_zip eb.id %}" class="btn btn-mini">{% trans "Export Results" %}</a>
    </form>
    <form id="edit-batch" class="form form-horizontal well" method="POST"
          style="display: none;">
      {% csrf_token %}
      <fieldset>
        {{ eb_form|as_bootstrap }}
        <div class="form-actions">
          <input type="submit" class="btn btn-primary" name="eb_edit"
                 value="{% trans 'Edit Evaluation Batch' %}"/>
        </div>
      </fieldset>
    </form>

  </section>

  <section id="batch">
    <h1>
      Evaluation Batch #{{ eb.id }}
      <small>({{ eb.get_access_display }})</small>
    </h1>
    <dl class="dl-horizontal">
      <dt>
        <strong>Benchmark:</strong>
      </dt>
      <dd>
        <a href="{% url b_detail bid=eb.benchmark.id %}">
          {{ eb.benchmark.name }}</a>
      </dd>
      <dt>
        <strong>Description:</strong>
      </dt>
      <dd>
        {{ eb.description|default:"no description" }}
      </dd>
      <dt>
        <strong>Algorithm:</strong>
      </dt>
      <dd>
        <a href="{{ eb.algorithm.get_absolute_url }}">{{ eb.algorithm }}</a>
      </dd>
      <dt>
        <strong>Author:</strong>
      </dt>
      <dd>
        {% icn_profile eb %}
      </dd>
      <dt>
        <strong>Date Created:</strong>
      </dt>
      <dd>
        {% icn_time eb %}
      </dd>
    </dl>
  </section>

  <section id="#trial-container" class="accordion" data-collapse-type="manual">
    {% for e in eb.evaluation_set.all %}
      {% include "spike_eval/evaluation/detail.html" %}
    {% endfor %}
  </section>

{% endblock %}

{% block extra_body %}
  <script type="text/javascript">
    $(document).ready(function () {
      $('#edit-batch-toggle').click(function () {
        $('#edit-batch').toggle();
        return false;
      });
      if ($('#edit-batch .error').length) {
        $('#edit-batch').show();
        $('#edit-batch .error').autoscroll();
      }
      ;
    });
  </script>
{% endblock %}
